<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Alison Hill &amp; Steven Bedrick" />


<title>Lab 04: Distributions &amp; Summary Statistics</title>

<script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BMI 5/625 Labs, Spring 2025</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="slides.html">Slides &amp; Reading</a>
</li>
<li>
  <a href="data-vis-resources.html">Resources</a>
</li>
<li>
  <a href="https://sakai.ohsu.edu/portal/site/BMI-525-1-AD-Sp25">Sakai</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Lab 04: Distributions &amp; Summary
Statistics</h1>
<h3 class="subtitle">BMI 5/625</h3>
<h4 class="author">Alison Hill &amp; Steven Bedrick</h4>

</div>


<div id="slides-for-today" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Slides for today</h1>
<iframe src="slides/04-slides.html" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="packages" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Packages</h1>
<p>New ones to install:</p>
<pre class="r"><code>install.packages(&quot;Hmisc&quot;)
install.packages(&quot;ggbeeswarm&quot;)
install.packages(&quot;skimr&quot;)
install.packages(&quot;janitor&quot;)
install.packages(&quot;ggdist&quot;)</code></pre>
<p>To load:</p>
<pre class="r"><code>library(tidyverse)
library(ggbeeswarm)</code></pre>
<pre><code>Error in library(ggbeeswarm): there is no package called &#39;ggbeeswarm&#39;</code></pre>
<pre class="r"><code>library(skimr)</code></pre>
<pre><code>Error in library(skimr): there is no package called &#39;skimr&#39;</code></pre>
<pre class="r"><code>library(janitor)
library(ggdist)</code></pre>
</div>
<div id="make-sample-data" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Make Sample data</h1>
<p>Below are simulated four distributions (n = 250 each), all with
similar measures of center (mean = 0) and spread (s.d. = 1), but with
distinctly different shapes.<a href="#fn1" class="footnote-ref"
id="fnref1"><sup>1</sup></a></p>
<ol style="list-style-type: decimal">
<li>A standard normal (<code>n</code>);</li>
<li>A skew-right distribution (<code>s</code>, Johnson distribution with
skewness 2.2 and kurtosis 13);</li>
<li>A leptikurtic distribution (<code>k</code>, Johnson distribution
with skewness 0 and kurtosis 30);</li>
<li>A bimodal distribution (<code>mm</code>, two normals with mean -0.95
and 0.95 and standard deviation 0.31).</li>
</ol>
<pre class="r"><code>#install.packages(&quot;SuppDists&quot;)
library(SuppDists)</code></pre>
<pre><code>Error in library(SuppDists): there is no package called &#39;SuppDists&#39;</code></pre>
<pre class="r"><code># this is used later to generate the s and k distributions
findParams &lt;- function(mu, sigma, skew, kurt) {
  value &lt;- JohnsonFit(c(mu, sigma, skew, kurt), moment=&quot;use&quot;)
    return(value)  
}</code></pre>
<pre class="r"><code># Generate sample data -------------------------------------------------------
set.seed(8675309)

# normal
n &lt;- rnorm(250) # 250 simulated draws from a normal distribution

# right-skew
s &lt;- rJohnson(250, findParams(0.0, 1.0, 2.2, 13.0))</code></pre>
<pre><code>Error in rJohnson(250, findParams(0, 1, 2.2, 13)): could not find function &quot;rJohnson&quot;</code></pre>
<pre class="r"><code># leptikurtic
k &lt;- rJohnson(250, findParams(0, 1, 0, 30))</code></pre>
<pre><code>Error in rJohnson(250, findParams(0, 1, 0, 30)): could not find function &quot;rJohnson&quot;</code></pre>
<pre class="r"><code># mixture
mm &lt;- rnorm(250, rep(c(-1, 1), each = 50) * sqrt(0.9), sqrt(0.1))</code></pre>
<div id="tidy-the-data" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Tidy the data</h2>
<p>Combine our four sets of samples</p>
<pre class="r"><code>four &lt;- data.frame(
  dist = factor(rep(c(&quot;n&quot;, &quot;s&quot;, &quot;k&quot;, &quot;mm&quot;), 
                    each = 250),
                c(&quot;n&quot;, &quot;s&quot;, &quot;k&quot;, &quot;mm&quot;)),
  vals = c(n, s, k, mm)
)</code></pre>
<pre><code>Error: object &#39;k&#39; not found</code></pre>
</div>
</div>
<div id="explore-the-data" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Explore the data</h1>
<pre class="r"><code>glimpse(four)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>Let’s see what our descriptive statistics look like:</p>
<pre class="r"><code>skim(four)</code></pre>
<pre><code>Error in skim(four): could not find function &quot;skim&quot;</code></pre>
<pre class="r"><code>four %&gt;% 
  group_by(dist) %&gt;% 
  skim()</code></pre>
<pre><code>Error in skim(.): could not find function &quot;skim&quot;</code></pre>
</div>
<div id="histograms" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Histograms</h1>
<p>For univariate distributions, Histograms are your go-to starting
place.</p>
<p>What you want to look for:</p>
<ul>
<li>How many “mounds” do you see? (modality)</li>
<li>If 1 mound, find the peak: are the areas to the left and right of
the peak symmetrical? (skewness)</li>
<li>Notice that kurtosis (peakedness) of the distribution is difficult
to judge here, especially given the effects of differing binwidths.</li>
</ul>
<p>When your data have natural “grouping”, this is a great use case for
<code>ggplot</code>’s <code>facet_wrap</code> feature; and the x- and
y-axes will be the same, and the size of histogram binwidths are also
the same. This is an example of the “small multiples” technique, in
which we are making a (potentially large!) number of
identically-formatted plots with the intention of facilitating
comparisons.</p>
<pre class="r"><code>#2 x 2 histograms in ggplot
ggplot(four, aes(x = vals)) + #no y needed for visualization of univariate distributions
  geom_histogram(fill = &quot;white&quot;, colour = &quot;black&quot;) + #easier to see for me
  coord_cartesian(xlim = c(-5, 5)) + #use this to change x/y limits!
  facet_wrap(~ dist) #this is one factor variable with 4 levels</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<div id="binwidths" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Binwidths</h2>
<p>Always change the binwidths on a histogram. Sometimes the default in
<code>ggplot</code> works great, sometimes it does not.</p>
<p>Super narrow:</p>
<pre class="r"><code>#2 x 2 histograms in ggplot
ggplot(four, aes(x = vals)) + 
  geom_histogram(binwidth = .1, fill = &quot;white&quot;, colour = &quot;black&quot;) + #super narrow bins
  coord_cartesian(xlim = c(-5, 5)) + 
  facet_wrap(~ dist)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>Super wide:</p>
<pre class="r"><code>#2 x 2 histograms in ggplot
ggplot(four, aes(x = vals)) + 
  geom_histogram(binwidth = 2, fill = &quot;white&quot;, colour = &quot;black&quot;) + #super wide bins
  coord_cartesian(xlim = c(-5, 5)) + 
  facet_wrap(~ dist)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>Just right? Pretty close to the default for this data.</p>
<pre class="r"><code>#2 x 2 histograms in ggplot
ggplot(four, aes(x = vals)) + 
  geom_histogram(binwidth = .2, fill = &quot;white&quot;, colour = &quot;black&quot;) + 
  coord_cartesian(xlim = c(-5, 5)) + 
  facet_wrap(~ dist)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
</div>
<div id="add-a-rug" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Add a rug</h2>
<p>A “rug” can help give additional insight into the underlying
distribution of data points- remember, a facted histogram like this can
obscure differences in sample size across groups!</p>
<pre class="r"><code>#2 x 2 histograms in ggplot
ggplot(four, aes(x = vals)) + 
  geom_histogram(binwidth = .2, fill = &quot;white&quot;, colour = &quot;black&quot;) + 
  geom_rug() + 
  coord_cartesian(xlim = c(-5, 5)) + 
  facet_wrap(~ dist)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
</div>
</div>
<div id="boxplots-medium-to-large-n" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Boxplots (medium to
large N)</h1>
<p>What you want to look for:</p>
<ul>
<li>The center line is the median: does the length of the distance to
the upper hinge appear equal to the length to the lower hinge?
(symmetry/skewness: Q3 - Q2/Q2 - Q1)</li>
<li>Are there many outliers?</li>
<li>Notice that modality of the distribution is difficult to judge
here.</li>
</ul>
<pre class="r"><code>ggplot(four, aes(y = vals, x = dist)) + 
  geom_boxplot() + 
  scale_x_discrete(name=&quot;&quot;) + 
  scale_y_continuous(name=&quot;&quot;) + 
  coord_cartesian(ylim = c(-4,4))</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<div id="add-notches" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Add notches</h2>
<p><a href="http://docs.ggplot2.org/0.9.3.1/geom_boxplot.html">ggplot
notches</a>: “Notches are used to compare groups; if the notches of two
boxes do not overlap, this is strong evidence that the medians differ.”
(Chambers et al., 1983, p. 62)</p>
<pre class="r"><code>ggplot(four, aes(y = vals, x = dist)) + 
  geom_boxplot(notch = T) + 
  scale_x_discrete(name = &quot;&quot;) + 
  scale_y_continuous(name = &quot;&quot;) + 
  coord_cartesian(ylim = c(-4,4))</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
</div>
<div id="add-summary-statistics" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Add summary
statistics</h2>
<p>We can use <code>stat_summary()</code> to add supplemental computed
points to the plot, corresponding to different summary statistics. Here
we are adding a diamond for the mean (see other possible shape codes <a
href="http://www.cookbook-r.com/Graphs/Shapes_and_line_types/">here</a>).</p>
<pre class="r"><code>ggplot(four, aes(x = dist, y = vals)) + 
  geom_boxplot() +
  stat_summary(fun.y = mean, 
               geom = &quot;point&quot;, 
               shape = 18, 
               size = 4, 
               colour = &quot;lightseagreen&quot;) + 
  coord_cartesian(ylim = c(-4, 4))</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
</div>
</div>
<div id="univariate-scatterplots-small-to-medium-n"
class="section level1" number="7">
<h1><span class="header-section-number">7</span> Univariate scatterplots
(small to medium n)</h1>
<p>Options:</p>
<ul>
<li><a
href="http://stat.ethz.ch/R-manual/R-patched/library/graphics/html/stripchart.html">Stripchart</a>:
“one dimensional scatter plots (or dot plots) of the given data. These
plots are a good alternative to boxplots when sample sizes are
small.”</li>
<li><a
href="https://cran.r-project.org/web/packages/beeswarm/beeswarm.pdf">Beeswarm</a>:
“A bee swarm plot is a one-dimensional scatter plot similar to
‘stripchart’, except that would-be overlapping points are separated such
that each is visible.”</li>
</ul>
<div id="stripchart" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Stripchart</h2>
<p>Combining <code>geom_jitter() + stat_summary()</code> is the ggplot
corollary to a stripchart.</p>
<pre class="r"><code>ggplot(four, aes(x = dist, y = vals)) +
  geom_jitter(position = position_jitter(height = 0, width = .1), 
              fill = &quot;lightseagreen&quot;, 
              colour = &quot;lightseagreen&quot;,
              alpha = .5) + 
  stat_summary(fun.y = median, 
               fun.ymin = median, 
               fun.ymax = median, 
               geom = &quot;crossbar&quot;, 
               width = 0.5) +
  scale_x_discrete(name = &quot;&quot;) + 
  scale_y_continuous(name = &quot;&quot;) + 
  coord_cartesian(ylim = c(-4, 4))</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>One tip for using stripcharts: make sure to experiment with different
values of <code>alpha</code>, as different distributions and sample
sizes will be best served by more or less transparency (and thus more or
less apparent overlap).</p>
</div>
<div id="dotplot" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Dotplot</h2>
<p>Dotplots visualize individual datapoints; various options control
details about the layout of the points.</p>
<pre class="r"><code>ggplot(four, aes(x = dist, y = vals)) +
  geom_dotplot(stackdir = &quot;center&quot;, 
               binaxis = &quot;y&quot;, 
               binwidth = .1,
               binpositions = &quot;all&quot;,
               stackratio = 1.5, 
               fill = &quot;lightseagreen&quot;, 
               colour = &quot;lightseagreen&quot;) + 
  scale_x_discrete(name = &quot;&quot;) + 
  scale_y_continuous(name = &quot;&quot;) + 
  coord_cartesian(ylim = c(-4, 4))</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
</div>
<div id="beeswarm" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Beeswarm</h2>
<p><a href="https://github.com/eclarke/ggbeeswarm">Beeswarm plots</a>
are a variation on the dot plot; <code>ggbeeswarm</code> has a number of
different options for controlling their layout:</p>
<pre class="r"><code>install.packages(&quot;ggbeeswarm&quot;)
library(ggbeeswarm)</code></pre>
<pre class="r"><code>ggplot(four, aes(x = dist, y = vals)) +
  geom_quasirandom(fill = &quot;lightseagreen&quot;, 
               colour = &quot;lightseagreen&quot;) + 
  scale_x_discrete(name = &quot;&quot;) + 
  scale_y_continuous(name = &quot;&quot;) + 
  coord_cartesian(ylim = c(-4, 4))</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<pre class="r"><code>ggplot(four, aes(x = dist, y = vals)) +
  geom_quasirandom(fill = &quot;lightseagreen&quot;, 
               colour = &quot;lightseagreen&quot;, 
               method = &quot;smiley&quot;) + 
  scale_x_discrete(name = &quot;&quot;) + 
  scale_y_continuous(name = &quot;&quot;) + 
  coord_cartesian(ylim = c(-4, 4))</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>Note that beeswarm plots don’t work so well if your data is “big”.
You will know your data is too big if you try the below methods and you
can’t see many of the individual points (typically, N &gt; 100).</p>
</div>
</div>
<div id="boxplots-univariate-scatterplots-small-to-medium-n"
class="section level1" number="8">
<h1><span class="header-section-number">8</span> Boxplots + univariate
scatterplots (small to medium n)</h1>
<p>Combining <code>geom_boxplot() + geom_dotplot()</code> is my personal
pick for EDA when I have small - medium data (N &lt; 100).</p>
<pre class="r"><code>ggplot(four, aes(y = vals, x = dist)) + 
  geom_boxplot(outlier.shape = NA) + 
  geom_dotplot(binaxis = &#39;y&#39;, 
               stackdir = &#39;center&#39;, 
               stackratio = 1.5, 
               binwidth = .1,
               binpositions = &quot;all&quot;,
               dotsize = 1,
               alpha = .75, 
               fill = &quot;lightseagreen&quot;, 
               colour = &quot;lightseagreen&quot;,
               na.rm = TRUE) + 
  scale_x_discrete(name = &quot;&quot;) + 
  scale_y_continuous(name = &quot;&quot;) + 
  coord_cartesian(ylim = c(-4, 4))</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>This gives us the “best of both worlds” in that we can see
descriptive statistics about the distributions as well as see the
underlying points themselves.</p>
<p>You can also combine <code>geom_boxplot() + geom_jitter()</code>. In
this case, note that the boxplot is configured to leave in the outliers,
even though it means that they will be double-plotted (once from
<code>geom_boxplot()</code> and once from <code>geom_jitter()</code>).
This is to demonstrate the jittered points are only being shifted from
left to right, because I set the jitter <code>height = 0</code>. What
happens if you tell <code>position_jitter()</code> to do something
different?</p>
<pre class="r"><code>ggplot(four, aes(y = vals, x = dist)) + 
  geom_boxplot(width = .5) + #note that the outlier points will be double-plotted
  geom_jitter(fill = &quot;lightseagreen&quot;, 
              colour = &quot;lightseagreen&quot;,
              na.rm = TRUE,
              position = position_jitter(height = 0, width = .1),
              alpha = .5) + 
  scale_x_discrete(name = &quot;&quot;) + 
  scale_y_continuous(name = &quot;&quot;) + 
  coord_cartesian(ylim = c(-4, 4))</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
</div>
<div id="density-plots-medium-to-large-n" class="section level1"
number="9">
<h1><span class="header-section-number">9</span> Density plots (medium
to large n)</h1>
<p>For larger sample sizes, showing the actual points themselves becomes
impractical, and density estimate plots become a better solution. A
density plot is a visualization of a <em>kernel density estimate</em>,
``a non-parametric way to estimate the probability density function of a
random variable.’’ (from <a
href="https://en.wikipedia.org/wiki/Kernel_density_estimation">wikipedia</a>).</p>
<p>A simple kernel density plot is very useful on its own, but there are
many variations. One popular one is the <em>violin plot</em>, which is
essentially a boxplot except with a mirrored KDE plot instead of a
rectangular box. Another variation combines a stripchart and a scatter
plot to form a “<a
href="https://cran.r-project.org/web/packages/beanplot/vignettes/beanplot.pdf">beanplot</a>”,
whose name “stems from green beans. The density shape can be seen as the
pod of a green bean, while the scatter plot shows the seeds inside the
pod.”</p>
<div id="density-plots" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Density plots</h2>
<p><code>ggplot</code>’s <code>geom_density()</code> will compute and
plot a KDE:</p>
<pre class="r"><code>ggplot(four, aes(x = vals)) + 
  geom_density(fill = &quot;lightseagreen&quot;) +
  coord_cartesian(xlim = c(-5, 5)) +
  facet_wrap(~ dist)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>Instead of doing a <code>facet_wrap</code>, I could make just one
plot showing all four distributions. To make each distribution a
different color, set the <code>fill</code> within the <code>aes</code>,
and assign it to the factor variable <code>dist</code>. Since now all
four will be plotted on top of each other, add an <code>alpha</code>
level to make the color fill transparent (0 = completely transparent; 1
= completely opaque).</p>
<pre class="r"><code># Density plots with semi-transparent fill
ggplot(four, aes(x = vals, fill = dist)) + 
  geom_density(alpha = .5)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>Keiran Healy has a <a
href="https://kieranhealy.org/blog/archives/2021/12/19/comparing-distributions/">lovely
essay</a> discussing different design approaches to this sort of
plot!</p>
<div id="add-a-histogram" class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Add a
histogram</h3>
<p>Sometimes one wants to combine a histogram and a density plot; while
these are pretty easy to make in <code>ggplot</code>, there are some
gotchas. In the plot below, note that the y-axis is different from if
you just plotted the histogram. In fact, when interpreting this plot,
the y-axis is only meaningful for reading density. It is meaningless for
interpreting the histogram.</p>
<pre class="r"><code>ggplot(four, aes(x = vals)) + 
  geom_histogram(aes(y = ..density..), 
                 binwidth = .5, 
                 colour = &quot;black&quot;, 
                 fill = &quot;white&quot;) +
  geom_density(alpha = .5, fill = &quot;lightseagreen&quot;) + 
  coord_cartesian(xlim = c(-5,5)) + 
  facet_wrap(~ dist)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>Question to consider: what does the y-axis represent in a histogram?
What does it represent in a density plot?</p>
</div>
</div>
<div id="violin-plots" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Violin plots</h2>
<p><code>ggplot</code>’s built-in <code>geom_violin()</code> will make
simple violin plots:</p>
<p>My advice: always set <code>color = NA</code> for
<code>geom_violin</code>. For fill, always set <code>alpha</code>.</p>
<pre class="r"><code>ggplot(four, aes(x = dist, y = vals)) +
    geom_violin(color = NA,
                fill = &quot;lightseagreen&quot;,
                alpha = .5,
                na.rm = TRUE,
                scale = &quot;count&quot;) + # max width proportional to sample size
  coord_cartesian(ylim = c(-4, 4))</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<div id="add-a-boxplot" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Add a boxplot</h3>
<p>A combination of <code>geom_violin() + geom_boxplot()</code> is my
personal pick for EDA when I have large data (N &gt; 100).</p>
<pre class="r"><code>ggplot(four, aes(x = dist, y = vals)) +
    geom_boxplot(outlier.size = 2, 
                 colour = &quot;lightseagreen&quot;,
                 fill = &quot;black&quot;,
                 na.rm = TRUE,
                 width = .1) + 
    geom_violin(alpha = .2, 
                fill = &quot;lightseagreen&quot;,
                colour = NA,
                na.rm = TRUE) +
  coord_cartesian(ylim = c(-4, 4))</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>Note that it is just as easy to layer a univariate scatterplot over a
violin plot, just by replacing the <code>geom_boxplot</code> with a
different geom as shown above. Lots of combination plots are
possible!</p>
</div>
</div>
</div>
<div id="split-violin" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Split violin</h1>
<p>For more sophisticated variations, we turn to the <code>ggdist</code>
package:</p>
<pre class="r"><code>install.packages(&quot;ggdist&quot;)
library(ggdist)</code></pre>
<p>It contains <code>geom</code>s and <code>stat</code>s that, when used
in combination with one another, will enable us to build many different
kinds of distribution visualizations.</p>
<p>For example, one popular variation on the violin plot is the “split
violin” plot, which removes the mirroring of the violin plot and uses
that space for other purposes.</p>
<p>For a traditional violin plot, use <code>stat_slab()</code></p>
<pre class="r"><code>ggplot(four, aes(x=dist, y=vals)) +
  stat_slab(fill=&quot;lightseagreen&quot;, trim=FALSE, side=&quot;both&quot;)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>To split, and only half one side, alter the <code>side</code>
setting:</p>
<pre class="r"><code>ggplot(four, aes(x=dist, y=vals)) +
  stat_slab(fill=&quot;lightseagreen&quot;, trim=FALSE, side=&quot;right&quot;)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>Personally, I prefer to smoosh things down a little bit, for a full
“split-violin” effect:</p>
<pre class="r"><code>ggplot(four, aes(x=dist, y=vals)) +
  stat_slab(fill=&quot;lightseagreen&quot;, trim=FALSE, side=&quot;right&quot;, scale=0.5)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p><code>ggdist</code> has many variations of this basic plot, including
ones with interval bars (<code>stat_slabinterval()</code>), etc.:</p>
<pre class="r"><code>ggplot(four, aes(x=dist, y=vals)) +
  stat_slabinterval(fill=&quot;lightseagreen&quot;, trim = FALSE, side=&quot;right&quot;, scale=0.5) </code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>And of course, we can re-orient our plot by changing the
<code>x</code> and <code>y</code> aesthetics:</p>
<pre class="r"><code>ggplot(four, aes(y = dist, x = vals)) +
    stat_slabinterval(fill=&quot;lightseagreen&quot;, trim = FALSE, side=&quot;right&quot;, scale=0.5)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
</div>
<div id="ridgeline-plots" class="section level1" number="11">
<h1><span class="header-section-number">11</span> Ridgeline plots</h1>
<p>For ridgeline plots, it makes the most sense to have the factor
variable (like <code>dist</code>) be on the y-axis. Ridgeline plots are
indicated when there is a relatively large number of levels to the
factor, and when comparison across factors is important.</p>
<pre class="r"><code>ggplot(four, aes(y = dist, x = vals)) +
    stat_slab(fill=&quot;lightseagreen&quot;, trim = FALSE, side=&quot;right&quot;, scale=0.5)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>(This isn’t an optimal use case for a ridgeline plot, we’re just
demonstrating…)</p>
<p>As an alternative to <code>ggdist</code>, you may want to check out
<a
href="https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html"><code>ggridges</code></a>,
a package entirely dedicated to ridgeline plots.</p>
</div>
<div id="raincloud-plots" class="section level1" number="12">
<h1><span class="header-section-number">12</span> Raincloud plots</h1>
<p>By combining <code>stat_slab</code> and <code>stat_dots</code>, we
can create a “raincloud” plot:</p>
<pre class="r"><code>ggplot(four, aes(y = dist, x = vals)) +
    stat_slab(fill=&quot;lightseagreen&quot;, trim = FALSE, side=&quot;right&quot;, scale=0.5) +
  stat_dots(side=&quot;left&quot;, alpha=0.5)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
</div>
<div id="plotting-summary-statistics" class="section level1"
number="13">
<h1><span class="header-section-number">13</span> Plotting summary
statistics</h1>
<p>Moving back to standard <code>ggplot</code> territory, let’s revisit
<code>stat_summary</code>. A more general way to look at
<code>stat_summary</code> is that it applies a “summary function” to the
variable mapped to <code>y</code> at each <code>x</code> value.</p>
<div id="means-and-error-bars" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Means and error
bars</h2>
<p>The simplest summary function is <code>mean_se</code>, which returns
the mean and the mean plus its standard error on each side. Thus,
<code>stat_summary</code> will calculate and plot the mean and standard
errors for the y variable at each x value.</p>
<p>The default geom is “pointrange” which places a dot at the central y
value and extends lines to the minimum and maximum y values. Other geoms
you might consider to display summarized data:</p>
<ul>
<li><code>geom_errorbar</code></li>
<li><code>geom_pointrange</code></li>
<li><code>geom_linerange</code></li>
<li><code>geom_crossbar</code></li>
</ul>
<p>There are a few summary functions from the <code>Hmisc</code> package
which are reformatted for use in <code>stat_summary()</code>. They all
return aesthetics for <code>y</code>, <code>ymax</code>, and
<code>ymin</code>.</p>
<ul>
<li><code>mean_cl_normal()</code>
<ul>
<li>Returns sample mean and 95% confidence intervals assuming normality
(i.e., t-distribution based)</li>
</ul></li>
<li><code>mean_sdl()</code>
<ul>
<li>Returns sample mean and a confidence interval based on the standard
deviation times some constant</li>
</ul></li>
<li><code>mean_cl_boot()</code>
<ul>
<li>Uses a bootstrap method to determine a confidence interval for the
sample mean without assuming normality.</li>
</ul></li>
<li><code>median_hilow()</code>
<ul>
<li>Returns the median and an upper and lower quantiles.</li>
</ul></li>
</ul>
<pre class="r"><code>ggplot(four, aes(x = dist, y = vals)) +
  stat_summary(fun.data = &quot;mean_se&quot;)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<pre class="r"><code>ggplot(four, aes(x = dist, y = vals)) +
  stat_summary(fun.y = &quot;mean&quot;, geom = &quot;point&quot;) +
  stat_summary(fun.y = &quot;max&quot;, geom = &quot;point&quot;, shape = 21)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<pre class="r"><code>ggplot(four, aes(x = dist, y = vals)) +
  stat_summary(fun.data = median_hilow)</code></pre>
<pre><code>Error: object &#39;four&#39; not found</code></pre>
<p>You may have noticed two different arguments that are potentially
confusing: <code>fun.data</code> and <code>fun.y</code>. If the function
returns three values, specify the function with the argument
<code>fun.data</code>. If the function returns one value, specify
<code>fun.y</code>. See below.</p>
<pre class="r"><code>x &lt;- c(1, 2, 3)
mean(x) # use fun.y</code></pre>
<pre><code>[1] 2</code></pre>
<pre class="r"><code>mean_cl_normal(x) # use fun.data</code></pre>
<pre><code>Error in `mean_cl_normal()`:
! The package &quot;Hmisc&quot; is required.</code></pre>
<p>Confidence limits may give us a better idea than standard error
limits of whether two means would be deemed statistically different when
modeling, so we frequently use <code>mean_cl_normal</code> or
<code>mean_cl_boot</code> in addition to <code>mean_se</code>.</p>
</div>
<div id="connecting-means-with-lines" class="section level2"
number="13.2">
<h2><span class="header-section-number">13.2</span> Connecting means
with lines</h2>
<p>Using the <code>ToothGrowth</code> dataset</p>
<pre class="r"><code>data(ToothGrowth)
tg &lt;- ToothGrowth</code></pre>
<pre class="r"><code># Standard error of the mean
ggplot(tg, aes(x = dose, y = len, colour = supp)) + 
  stat_summary(fun.data = &quot;mean_se&quot;) +
  ggtitle(&quot;Mean +/- SE&quot;)</code></pre>
<p><img src="04-distributions_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code># Connect the points with lines
ggplot(tg, aes(x = dose, y = len, colour = supp)) + 
  stat_summary(fun.data = &quot;mean_se&quot;) +
  stat_summary(fun.y = mean, geom = &quot;line&quot;) +
  ggtitle(&quot;Mean +/- SE&quot;)</code></pre>
<p><img src="04-distributions_files/figure-html/unnamed-chunk-19-2.png" width="672" /></p>
<pre class="r"><code># Use 95% confidence interval instead of SEM
ggplot(tg, aes(x = dose, y = len, colour = supp)) + 
  stat_summary(fun.data = &quot;mean_cl_normal&quot;) +
  stat_summary(fun.y = mean, geom = &quot;line&quot;) +
  ggtitle(&quot;Mean with 95% confidence intervals&quot;)</code></pre>
<p><img src="04-distributions_files/figure-html/unnamed-chunk-19-3.png" width="672" /></p>
<pre class="r"><code># The errorbars overlapped, so use position_dodge to move them horizontally
pd &lt;- position_dodge(0.1) # move them .05 to the left and right

ggplot(tg, aes(x = dose, y = len, colour = supp)) + 
  stat_summary(fun.data = &quot;mean_cl_normal&quot;, position = pd) +
  stat_summary(fun.y = mean, geom = &quot;line&quot;, position = pd) +
  ggtitle(&quot;Mean with 95% confidence intervals&quot;)</code></pre>
<p><img src="04-distributions_files/figure-html/unnamed-chunk-19-4.png" width="672" /></p>
<p>Not the best example for this geom, but another good one for showing
variability…</p>
<pre class="r"><code># ribbon geom
ggplot(tg, aes(x = dose, y = len, colour = supp, fill = supp)) + 
  stat_summary(fun.y = mean, geom = &quot;line&quot;) +
  stat_summary(fun.data = mean_se, geom = &quot;ribbon&quot;, alpha = .5)</code></pre>
<p><img src="04-distributions_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="bars-with-error-bars" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Bars with error
bars</h2>
<p>This is not an ideal practice, but sometimes you must…</p>
<pre class="r"><code># Standard error of the mean; note positioning
ggplot(tg, aes(x = factor(dose), y = len, fill = supp)) + 
  stat_summary(fun.y = mean, geom = &quot;bar&quot;, position = position_dodge(width = .9)) +
  stat_summary(fun.data = mean_se, geom = &quot;linerange&quot;, position = position_dodge(width = .9)) +
  ggtitle(&quot;Mean +/- SE&quot;)</code></pre>
<p><img src="04-distributions_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>The key trick here is telling <code>stat_summary</code> to use the
“bar” geom instead of its default (point or linerange).</p>
<p>Note that it is important to be clear about whether your error bars
represent the standard error of the mean, or a true confidence interval,
which can be computed as follows:</p>
<pre class="r"><code># Use 95% confidence interval instead of SEM
ggplot(tg, aes(x = factor(dose), y = len, fill = supp)) + 
  stat_summary(fun.y = mean, geom = &quot;bar&quot;, position = position_dodge(width = .9)) +
  stat_summary(fun.data = mean_cl_boot, geom = &quot;linerange&quot;, position = position_dodge(width = .9)) +
  ggtitle(&quot;Mean with 95% confidence intervals&quot;)</code></pre>
<p><img src="04-distributions_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>More help here: <a
href="http://www.cookbook-r.com/Graphs/Plotting_means_and_error_bars_(ggplot2)/"
class="uri">http://www.cookbook-r.com/Graphs/Plotting_means_and_error_bars_(ggplot2)/</a></p>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>The <a
href="https://github.com/hadley/boxplots-paper/blob/master/boxplots-density.r">code
for these distributions</a> originally came from Hadley Wickham’s paper
on <a href="http://vita.had.co.nz/papers/boxplots.html">“40 years of
boxplots”</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

<p>
<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="by-nc.png" width="133" height="25"/></a>
</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
